

  api:loopback:middleware:token(options)
    loopback.token({})
      √ header
    options
      searchDefaultTokenKeys:[true|false]
        normal usage
          √ header, headers is empty, true
          √ header, headers has header, false
        unormal usage: testing or unknown usage
          √ header, headers is empty, false


  4 passing (62ms)



  api:loopback:middleware:token(options)
    loopback.token({})
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment testOptions:
{}
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.testOptions:
{ expect: 200, header: 'authorization', get: '/' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment tokenOptions:
{}
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.tokenOptions:
{}
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment startApp
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token startApp started
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId sendReq
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId tokenId:
'CSqYmrCxOZk2yNHBD3HL3mFhaDeazCKjuDANwrXTtdmuIqkID8nCbzGF4VSWgoHl'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token sendReq header tokenId:
'authorization'
'CSqYmrCxOZk2yNHBD3HL3mFhaDeazCKjuDANwrXTtdmuIqkID8nCbzGF4VSWgoHl'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appget req.headers:
{ host: '127.0.0.1:21338',
  'accept-encoding': 'gzip, deflate',
  'user-agent': 'node-superagent/0.21.0',
  authorization: 'CSqYmrCxOZk2yNHBD3HL3mFhaDeazCKjuDANwrXTtdmuIqkID8nCbzGF4VSWgoHl',
  connection: 'close' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appGet 200 token:
{ id: 'CSqYmrCxOZk2yNHBD3HL3mFhaDeazCKjuDANwrXTtdmuIqkID8nCbzGF4VSWgoHl',
  ttl: 1209600,
  created: Mon May 11 2015 23:00:33 GMT+0200 (Romance Daylight Time) }
      √ header
    options
      searchDefaultTokenKeys:[true|false]
        normal usage
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment testOptions:
{ expect: 200, header: 'authorization' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.testOptions:
{ expect: 200, header: 'authorization', get: '/' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment tokenOptions:
{ searchDefaultTokenKeys: true, headers: [] }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.tokenOptions:
{ searchDefaultTokenKeys: true, headers: [] }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment startApp
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token startApp started
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId sendReq
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId tokenId:
'QoFlcWAFVU7o18P5tEV0y21NQdaaMqbhLhhZhwhUlgkvABRwn2Gh07gKB5GgL3cN'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token sendReq header tokenId:
'authorization'
'QoFlcWAFVU7o18P5tEV0y21NQdaaMqbhLhhZhwhUlgkvABRwn2Gh07gKB5GgL3cN'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appget req.headers:
{ host: '127.0.0.1:21340',
  'accept-encoding': 'gzip, deflate',
  'user-agent': 'node-superagent/0.21.0',
  authorization: 'QoFlcWAFVU7o18P5tEV0y21NQdaaMqbhLhhZhwhUlgkvABRwn2Gh07gKB5GgL3cN',
  connection: 'close' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appGet 200 token:
{ id: 'QoFlcWAFVU7o18P5tEV0y21NQdaaMqbhLhhZhwhUlgkvABRwn2Gh07gKB5GgL3cN',
  ttl: 1209600,
  created: Mon May 11 2015 23:00:33 GMT+0200 (Romance Daylight Time) }
          √ header, headers is empty, true
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment testOptions:
{ expect: 200, header: 'authorization' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.testOptions:
{ expect: 200, header: 'authorization', get: '/' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment tokenOptions:
{ searchDefaultTokenKeys: false, headers: [ 'authorization' ] }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.tokenOptions:
{ searchDefaultTokenKeys: false, headers: [ 'authorization' ] }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment startApp
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token startApp started
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId sendReq
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId tokenId:
'4AxLKXogw5UzfqRuIQFYCvr44Dsth2B8rYWlkRRbALY1aAtiBphk6WuD9rqFzqIw'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token sendReq header tokenId:
'authorization'
'4AxLKXogw5UzfqRuIQFYCvr44Dsth2B8rYWlkRRbALY1aAtiBphk6WuD9rqFzqIw'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appget req.headers:
{ host: '127.0.0.1:21342',
  'accept-encoding': 'gzip, deflate',
  'user-agent': 'node-superagent/0.21.0',
  authorization: '4AxLKXogw5UzfqRuIQFYCvr44Dsth2B8rYWlkRRbALY1aAtiBphk6WuD9rqFzqIw',
  connection: 'close' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appGet 200 token:
{ id: '4AxLKXogw5UzfqRuIQFYCvr44Dsth2B8rYWlkRRbALY1aAtiBphk6WuD9rqFzqIw',
  ttl: 1209600,
  created: Mon May 11 2015 23:00:33 GMT+0200 (Romance Daylight Time) }
          √ header, headers has header, false
        unormal usage: testing or unknown usage
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment testOptions:
{ expect: 401, header: 'authorization' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.testOptions:
{ expect: 401, header: 'authorization', get: '/' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment tokenOptions:
{ searchDefaultTokenKeys: false, headers: [] }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment this.tokenOptions:
{ searchDefaultTokenKeys: false, headers: [] }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token TestEnvironment startApp
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token startApp started
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId sendReq
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token runTest createTokenId tokenId:
'96zlzmWEUVHzVlJBYt42pgsT3puFR1b4UW4E6rKnyZnngjLBrJO3Djs5zJo8R9VU'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token sendReq header tokenId:
'authorization'
'96zlzmWEUVHzVlJBYt42pgsT3puFR1b4UW4E6rKnyZnngjLBrJO3Djs5zJo8R9VU'
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appget req.headers:
{ host: '127.0.0.1:21344',
  'accept-encoding': 'gzip, deflate',
  'user-agent': 'node-superagent/0.21.0',
  authorization: '96zlzmWEUVHzVlJBYt42pgsT3puFR1b4UW4E6rKnyZnngjLBrJO3Djs5zJo8R9VU',
  connection: 'close' }
Mon, 11 May 2015 21:00:33 GMT api:loopback:middleware:token appGet 401 err token:
undefined
undefined
          √ header, headers is empty, false


  4 passing (78ms)

